<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Methodology & Guide - FitRep Calculator</title>

    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* --- GLOBAL VARIABLES & RESET --- */
        :root {
            --bg-color: #ffffff;
            --text-main: #212529;
            --text-muted: #6c757d;
            --accent-color: #2563eb;
            --border-color: #e5e7eb;
            --warning-bg: #fff3cd;
            --warning-text: #856404;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.7;
            color: var(--text-main);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navigation */
        nav {
            border-bottom: 1px solid var(--border-color);
            padding: 15px 0;
            background: #fff;
            margin-bottom: 50px;
        }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
        .nav-link { text-decoration: none; color: var(--text-muted); font-weight: 500; font-size: 0.9rem; }
        .nav-link:hover { color: var(--text-main); }

        /* Typography */
        h1 { font-size: 2.25rem; font-weight: 800; margin-bottom: 10px; letter-spacing: -0.02em; }
        h2 { margin-top: 50px; margin-bottom: 20px; font-size: 1.5rem; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #111; }
        h3 { margin-top: 30px; margin-bottom: 15px; font-size: 1.15rem; font-weight: 700; color: #374151; }
        p { margin-bottom: 20px; font-size: 1.05rem; color: #374151; }

        /* Lists */
        ul, ol { margin-bottom: 20px; padding-left: 20px; }
        li { margin-bottom: 10px; color: #374151; font-size: 1.05rem; }

        /* Components */
        .subtitle { font-size: 1.25rem; color: var(--text-muted); margin-bottom: 40px; font-weight: 400; }

        .callout {
            background: #f3f4f6;
            border-left: 4px solid var(--accent-color);
            padding: 20px;
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
        }

        .warning-box {
            background-color: var(--warning-bg);
            color: var(--warning-text);
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #ffeeba;
            font-size: 0.95rem;
            margin-bottom: 20px;
        }

        .citation {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-style: italic;
            border-left: 2px solid #ddd;
            padding-left: 15px;
            margin: 20px 0;
        }

        /* Footer */
        footer { background-color: #1f2937; color: #d1d5db; padding: 40px 0; font-size: 0.85rem; text-align: center; margin-top: 80px; }
        footer a { color: #fff; }
    </style>
</head>
<body>

    <nav>
        <div class="container nav-content">
            <a href="index.html" class="nav-link">&larr; Back to App</a>
            <a href="https://github.com/njp-2024/fitrep-calculator" class="nav-link" target="_blank">View on GitHub</a>
        </div>
    </nav>

    <main class="container">

        <header>
            <h1>Methodology & Guide</h1>
            <p class="subtitle">Understanding the calculations, AI drafting, and limitations of the FitRep Calculator.</p>
        </header>

        <section>
            <h2>The Communication Gap</h2>
            <p>For Reporting Seniors (RS), Relative Value (RV) and Section I comments are two of the most important components of Fitness Reports considered by selection boards. Yet, Reporting Seniors currently operate with a significant blind spot: <strong>they cannot see the projected RV of a report before submitting it.</strong></p>

            <p>This creates a communication gap. While the RS communicates performance via raw attribute scores, the selection board interprets performance via Relative Value. As noted in Baker and Kwan’s 2015 <em>Marine Corps Gazette</em> article, <a href="https://scholarspace.manoa.hawaii.edu/items/01c4c148-706d-4340-9773-455435942738" target="_blank">“Miscalculating Performance,”</a> the RV calculation is more complicated and nuanced than most realize. This can lead to unintentional miscommunications that negatively impact the evaluation process.</p>

            <p><strong>The Solution:</strong> This tool bridges that gap by estimating Relative Value in real-time. It requires no downloads, no PDF imports, and no maintenance of complex Excel trackers.</p>

            <div class="callout">
                <strong>Decision Support, Not Automation.</strong><br>
                The intended workflow is for the RS to score reports per the PES first, then use this tool to confirm the Board will interpret the report exactly as intended.
            </div>
        </section>

        <section>
            <h2 id="rv-engine">The Relative Value Engine</h2>
            <p>To get the most out of this tool, users must understand how the engine handles data processing and precision.</p>

            <h3>1. The "Precision Gap" (Rounding Errors)</h3>
            <p>Your Official Military Personnel File (OMPF) rounds all report values to two decimal places. This creates a precision issue when using them for calculations. The tool handles this in two ways:</p>
            <ul>
                <li><strong>Reverse-Engineering the Profile High:</strong> The tool takes your rounded Profile High (e.g., 4.08) and compares it against a lookup table of all possible raw scores (e.g., 53 points divided by 13 attributes). This allows us to recover the full-precision value for accurate calculation.</li>
            </ul>

            <div class="warning-box">
                <strong>NOTE:</strong> The tool assumes the Profile High was scored out of 13 or 14 attributes. If you know your Profile High was scored on fewer attributes, the tool may produce inaccurate results.
            </div>

            <ul>
                <li><strong>Range-Bound Profile Averages:</strong> Because a Profile Average is an aggregate of many reports, we cannot "reverse engineer" it to a single precise number. Instead, the tool calculates the <strong>minimum and maximum possible RV</strong> based on the rounding error. This provides you with a transparent accuracy range, ensuring you aren't misled by a single, potentially inaccurate number.</li>
            </ul>

            <h3>2. Processing Order</h3>
            <p>The algorithm assumes MMRP processes reports in the linear order they are received, without regard to end date or reporting occasion. Actual RV at processing values may differ depending on MMRP’s actual processing order. However, <strong>Cumulative RV</strong> would not be affected.</p>
            <p><strong>Best Practice:</strong> If analyzing multiple reports, enter them in the chronological order you intend to submit them and focus on Cumulative RV.</p>

            <h3>3. The Formula</h3>
            <p>The tool uses the standard algorithm to project Relative Value:</p>

            $$
            RV =
            \begin{cases}
            0, & \text{if reports} < 3 \\
            90, & \text{if reports} \ge 3 \text{ and } \text{High} = \text{Avg} \\
            \max\left(80, 90 + 10 \times \frac{Rpt_{avg} - RS_{avg}}{RS_{high} - RS_{avg}}\right)
            \end{cases}
            $$

        </section>

        <section>
            <h2 id="ai-drafter">AI-Assisted Drafting</h2>
            <p>A common complaint from selection boards is that narrative comments do not align with the report score. The drafting assistant addresses this by using your projected RV to draft comments that align in tone with that score.</p>

            <h3>How it Works: Few-Shot Prompting</h3>
            <p>The tool uses a technique called "few-shot prompting." It selects publicly available examples (similar to those provided to new officers at TBS) that align with your calculated RV. It then feeds these examples to the Large Language Model (LLM) alongside your selected attributes to generate a draft.</p>
            <p>Prompt structures are dynamically adjusted based on the selected model. The comprehensive prompt displayed in the UI is optimized for large foundation models (like GPT-4). If you select the open weight or local model options, the tool automatically simplifies the instructions to align with that model's reasoning capabilities and context window.</p>

            <h3>Considerations</h3>
            <ul>
                <li><strong>Words Have Meaning:</strong> Effective narratives require more than just statistical alignment with Relative Value. We strongly recommend reviewing LtCol Tierney’s 2019 Gazette Article, <a href="#">“Words Have Meaning – Are you aware of what you are writing?”</a> for a detailed discussion on Section I writing technique. It is your responsibility to communicate accurate information—do not offload this to a machine.</li>
                <li><strong>Experimental Feature:</strong> This feature is currently experimental. It is set up to query three tiers of language models to compare capabilities and cost:
                    <ul>
                        <li><strong>Local:</strong> Requires Local Deployment. Not available in the web app; you must clone the repository from GitHub. Designed for advanced users to run small (7b-8b) parameter models offline on a personal PC.</li>
                        <li><strong>Open Weight:</strong> Requires Local Deployment. Not available in the web app; you must clone the repository from GitHub. Configured to interface with open-source models via Hugging Face, demonstrating that expensive commercial foundation models are not the only option.</li>
                        <li><strong>Foundation:</strong> The primary online option. The tool uses OpenAI’s API to query <code>gpt-4o-mini</code> for narrative generation.</li>
                    </ul>
                </li>
            </ul>

            <p>The purpose of providing these options is to compare capabilities and cost. While the foundation models are typically more expensive to access through the API, a centralized interface like this tool could offset the cost with more efficient token usage. Alternatively, self-hosting open weight models could be an economical solution if infrastructure allows.</p>

            <div class="callout">
                For user convenience, the tool prints the generated prompts for you to download or copy. You can run them in a more powerful model in your own browser if you prefer.
            </div>
        </section>

        <section>
            <h2>Privacy & Security</h2>
            <p>This tool is designed to be used without identifying information. The app runs in Streamlit’s Community Cloud.</p>
            <ul>
                <li><strong>No Persistent Storage:</strong> Data entered is processed in temporary memory and is not saved to any database. All inputs are erased immediately upon refresh or when the session ends.</li>
                <li><strong>API Transmission</strong> If you use the AI Drafting feature, the specific data required for the draft (accomplishments and user context) is transmitted to the LLM provider (e.g., OpenAI) for processing. Per OpenAI's API policy, this data is not used for model training.</li>
                <li><strong>No Uploads:</strong> We intentionally omitted an "Upload Profile" feature to avoid handling Controlled Unclassified Information (CUI).</li>
                <li><strong>Anonymity:</strong> Use fake names or placeholders. Do not enter specific CUI into the narrative generator fields.</li>
            </ul>
        </section>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 FitRep Calculator Project.</p>
            <p>
                <a href="index.html">Back to App</a> |
                <a href="https://forms.gle/YOUR_GOOGLE_FORM_ID" target="_blank">Leave Feedback</a>
            </p>
        </div>
    </footer>

</body>
</html>